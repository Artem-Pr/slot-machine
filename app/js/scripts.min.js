"use strict";

window.onload = function () {
  var btnStart = document.querySelector('.btn-start');
  var reelStage = document.querySelector('.reel__stage');
  var reelWrapper = reelStage.querySelector('.reel__wrapper');
  var symbols = ['BAR', '2xBAR', '3xBAR', '7', 'CHERRY'];
  var landPositions = {
    top: 1,
    center: 2,
    bottom: 3
  };

  function getRandomSymbols(symbols) {
    var j = 0,
        temp,
        mountOfElements = symbols.length;

    while (mountOfElements--) {
      j = Math.floor(Math.random() * (mountOfElements + 1));
      temp = symbols[mountOfElements];
      symbols[mountOfElements] = symbols[j];
      symbols[j] = temp;
    }

    return symbols;
  }

  var randomSymbols = getRandomSymbols(symbols);
  randomSymbols.forEach(function (item) {
    var reelImg = document.createElement('img');
    reelImg.src = 'img/reel/' + item + '.png';
    reelImg.alt = item;
    reelImg.className = 'reel__img';
    reelWrapper.append(reelImg);
  });

  function setCertainPosition(symbolsArr, goalRow, goalSymbol) {
    if (goalRow && goalSymbol) {
      var rowNumber = landPositions[goalRow];

      while (symbolsArr[rowNumber] !== goalSymbol) {
        symbolsArr.unshift(symbolsArr.pop());
      }
    }
  }

  btnStart.addEventListener('click', function () {
    var goalRow = document.querySelector('.goal-row').value;
    var goalSymbol = document.querySelector('.goal-symbol').value;
    var transform = 0;
    setCertainPosition(randomSymbols, goalRow, goalSymbol);

    var _loop = function _loop(i) {
      transform = 100 * i;
      var newReelWrapper = document.createElement('div');
      newReelWrapper.className = 'reel__wrapper';
      randomSymbols.forEach(function (item) {
        var reelImg = document.createElement('img');
        reelImg.src = 'img/reel/' + item + '.png';
        reelImg.alt = item;
        reelImg.className = 'reel__img';
        newReelWrapper.append(reelImg);
      });
      reelStage.prepend(newReelWrapper);
      newReelWrapper.style.transform = 'translateY(' + -transform + '%)';
    };

    for (var i = 1; i <= 5; i++) {
      _loop(i);
    }

    reelStage.style.transform = 'translateY(' + transform + '%)';
  });
};